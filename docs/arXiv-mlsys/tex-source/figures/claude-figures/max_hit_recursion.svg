<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 970 440"
     font-family="Arial, Helvetica, sans-serif" font-size="22">

  <!-- ==================== LEGEND ==================== -->
  <polygon points="30,12 48,12 48,7 60,18 48,29 48,24 30,24"
           fill="#B8B8B8"/>
  <text x="72" y="26" font-size="25" font-weight="bold" fill="#222">GGR Recursion Step</text>

  <rect x="420" y="6" width="30" height="30" rx="2"
        fill="#FEF3CD" stroke="#DAA520" stroke-width="2"/>
  <text x="462" y="30" font-size="25" font-weight="bold" fill="#222">Max Hit Count Distinct Value Group</text>

  <!-- ==================== LEFT TABLE ==================== -->
  <!-- Single table: 6 rows, 3 columns -->
  <g stroke="#333" stroke-width="2" fill="none">
    <rect x="30" y="78" width="160" height="252"/>
    <!-- Horizontal row dividers -->
    <line x1="30" y1="120" x2="190" y2="120"/>
    <line x1="30" y1="162" x2="190" y2="162"/>
    <line x1="30" y1="204" x2="190" y2="204"/>
    <line x1="30" y1="246" x2="190" y2="246"/>
    <line x1="30" y1="288" x2="190" y2="288"/>
    <!-- Vertical column dividers (3 columns) -->
    <line x1="90"  y1="78"  x2="90"  y2="330"/>
    <line x1="140" y1="78"  x2="140" y2="330"/>
  </g>
  <!-- b values in column 2, rows 0-2 -->
  <text x="115" y="106" text-anchor="middle" fill="#333">b</text>
  <text x="115" y="148" text-anchor="middle" fill="#333">b</text>
  <text x="115" y="190" text-anchor="middle" fill="#333">b</text>
  <!-- v values in column 3, rows 0-3 -->
  <text x="165" y="106" text-anchor="middle" fill="#333">v</text>
  <text x="165" y="148" text-anchor="middle" fill="#333">v</text>
  <text x="165" y="190" text-anchor="middle" fill="#333">v</text>
  <text x="165" y="232" text-anchor="middle" fill="#333">v</text>
  <!-- a values in column 1, rows 4-5 -->
  <text x="60" y="274" text-anchor="middle" fill="#333">a</text>
  <text x="60" y="316" text-anchor="middle" fill="#333">a</text>

  <!-- ==================== ARROW 1 ==================== -->
  <polygon points="215,195 258,195 258,181 292,210 258,239 258,225 215,225"
           fill="#B8B8B8"/>

  <!-- ==================== MIDDLE SECTION ==================== -->

  <!-- Top Group: Yellow column (v) + Blue solid area (b + rest) -->
  <!-- Yellow rect (value column: v) — solid border -->
  <rect x="340" y="68" width="75" height="190" rx="2"
        fill="#FEF3CD" stroke="#DAA520" stroke-width="2"/>
  <text x="377" y="98"  text-anchor="middle" fill="#333">v</text>
  <text x="377" y="146" text-anchor="middle" fill="#333">v</text>
  <text x="377" y="193" text-anchor="middle" fill="#333">v</text>
  <text x="377" y="240" text-anchor="middle" fill="#333">v</text>

  <!-- Blue rect (rest columns) — solid border, 10px gap from yellow -->
  <rect x="425" y="68" width="140" height="190" rx="2"
        fill="#CCE0F5" stroke="#4A86C8" stroke-width="2"/>
  <!-- Internal dashed horizontal lines -->
  <line x1="425" y1="116" x2="565" y2="116"
        stroke="#4A86C8" stroke-width="1.5" stroke-dasharray="6,4"/>
  <line x1="425" y1="163" x2="565" y2="163"
        stroke="#4A86C8" stroke-width="1.5" stroke-dasharray="6,4"/>
  <line x1="425" y1="210" x2="565" y2="210"
        stroke="#4A86C8" stroke-width="1.5" stroke-dasharray="6,4"/>
  <!-- Internal dashed vertical line -->
  <line x1="495" y1="68" x2="495" y2="258"
        stroke="#4A86C8" stroke-width="1.5" stroke-dasharray="6,4"/>
  <!-- b values in blue area, column 2 (right), rows 0-2 (row 3 empty) -->
  <text x="530" y="98"  text-anchor="middle" fill="#333">b</text>
  <text x="530" y="146" text-anchor="middle" fill="#333">b</text>
  <text x="530" y="193" text-anchor="middle" fill="#333">b</text>

  <!-- Bottom Group: Green solid-border area, 10px gap from top group -->
  <rect x="340" y="268" width="225" height="94" rx="2"
        fill="#D5ECC5" stroke="#6B9F4A" stroke-width="2"/>
  <!-- Internal dashed horizontal line -->
  <line x1="340" y1="315" x2="565" y2="315"
        stroke="#6B9F4A" stroke-width="1.5" stroke-dasharray="6,4"/>
  <!-- Internal dashed vertical lines -->
  <line x1="415" y1="268" x2="415" y2="362"
        stroke="#6B9F4A" stroke-width="1.5" stroke-dasharray="6,4"/>
  <line x1="490" y1="268" x2="490" y2="362"
        stroke="#6B9F4A" stroke-width="1.5" stroke-dasharray="6,4"/>
  <!-- a values -->
  <text x="377" y="300" text-anchor="middle" fill="#333">a</text>
  <text x="377" y="346" text-anchor="middle" fill="#333">a</text>

  <!-- ==================== ARROW 2 (TOP) ==================== -->
  <polygon points="595,148 635,148 635,135 670,163 635,191 635,178 595,178"
           fill="#B8B8B8"/>

  <!-- ==================== ARROW 2 (BOTTOM) ==================== -->
  <polygon points="595,300 635,300 635,287 670,315 635,343 635,330 595,330"
           fill="#B8B8B8"/>

  <!-- ==================== RIGHT SECTION ==================== -->

  <!-- Top Group: 3 areas -->
  <!-- 1) Yellow solid-border column (b,b,b) — 3 rows -->
  <rect x="748" y="48" width="75" height="143" rx="2"
        fill="#FEF3CD" stroke="#DAA520" stroke-width="2"/>
  <text x="785" y="78"  text-anchor="middle" fill="#333">b</text>
  <text x="785" y="126" text-anchor="middle" fill="#333">b</text>
  <text x="785" y="173" text-anchor="middle" fill="#333">b</text>

  <!-- 2) Blue solid-border area (1 empty column) — to the right, 10px gap -->
  <rect x="833" y="48" width="92" height="143" rx="2"
        fill="#CCE0F5" stroke="#4A86C8" stroke-width="2"/>
  <!-- Internal dashed horizontal lines -->
  <line x1="833" y1="96" x2="925" y2="96"
        stroke="#4A86C8" stroke-width="1.5" stroke-dasharray="6,4"/>
  <line x1="833" y1="143" x2="925" y2="143"
        stroke="#4A86C8" stroke-width="1.5" stroke-dasharray="6,4"/>

  <!-- 3) Green solid-border area (2 empty columns) — below, 10px gap -->
  <rect x="748" y="201" width="177" height="47" rx="2"
        fill="#D5ECC5" stroke="#6B9F4A" stroke-width="2"/>
  <!-- Internal dashed vertical line -->
  <line x1="837" y1="201" x2="837" y2="248"
        stroke="#6B9F4A" stroke-width="1.5" stroke-dasharray="6,4"/>

  <!-- Bottom Group: Yellow solid (a) + Blue solid (rest), 40px gap from top group -->
  <!-- Yellow solid rect (a values) -->
  <rect x="748" y="288" width="70" height="94" rx="2"
        fill="#FEF3CD" stroke="#DAA520" stroke-width="2"/>
  <line x1="748" y1="335" x2="818" y2="335"
        stroke="#DAA520" stroke-width="1.5" stroke-dasharray="6,4"/>
  <text x="783" y="320" text-anchor="middle" fill="#333">a</text>
  <text x="783" y="366" text-anchor="middle" fill="#333">a</text>

  <!-- Blue solid rect (empty rest columns), 10px gap from yellow -->
  <rect x="828" y="288" width="97" height="94" rx="2"
        fill="#CCE0F5" stroke="#4A86C8" stroke-width="2"/>
  <line x1="828" y1="335" x2="925" y2="335"
        stroke="#4A86C8" stroke-width="1.5" stroke-dasharray="6,4"/>
  <line x1="877" y1="288" x2="877" y2="382"
        stroke="#4A86C8" stroke-width="1.5" stroke-dasharray="6,4"/>

</svg>
